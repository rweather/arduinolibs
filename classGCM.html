<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Arduino Cryptography Library: GCM&lt; T &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Arduino Cryptography Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classGCM-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">GCM&lt; T &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implementation of the Galois Counter Mode (<a class="el" href="classGCM.html" title="Implementation of the Galois Counter Mode (GCM).">GCM</a>).  
 <a href="classGCM.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="GCM_8h_source.html">GCM.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for GCM&lt; T &gt;:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classGCM.png" usemap="#GCM_3C_20T_20_3E_map" alt=""/>
  <map id="GCM_3C_20T_20_3E_map" name="GCM_3C_20T_20_3E_map">
<area href="classGCMCommon.html" title="Concrete base class to assist with implementing GCM for 128-bit block ciphers." alt="GCMCommon" shape="rect" coords="0,112,127,136"/>
<area href="classAuthenticatedCipher.html" title="Abstract base class for authenticated ciphers." alt="AuthenticatedCipher" shape="rect" coords="0,56,127,80"/>
<area href="classCipher.html" title="Abstract base class for stream ciphers." alt="Cipher" shape="rect" coords="0,0,127,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:acbef04a5593177aabf19df538ad3def7"><td class="memItemLeft" align="right" valign="top"><a id="acbef04a5593177aabf19df538ad3def7"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGCM.html#acbef04a5593177aabf19df538ad3def7">GCM</a> ()</td></tr>
<tr class="memdesc:acbef04a5593177aabf19df538ad3def7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a new <a class="el" href="classGCM.html" title="Implementation of the Galois Counter Mode (GCM).">GCM</a> object for the block cipher T. <br /></td></tr>
<tr class="separator:acbef04a5593177aabf19df538ad3def7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classGCMCommon"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classGCMCommon')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classGCMCommon.html">GCMCommon</a></td></tr>
<tr class="memitem:a0d3e1525d91adbbdcd5ac27793817112 inherit pub_methods_classGCMCommon"><td class="memItemLeft" align="right" valign="top"><a id="a0d3e1525d91adbbdcd5ac27793817112"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGCMCommon.html#a0d3e1525d91adbbdcd5ac27793817112">~GCMCommon</a> ()</td></tr>
<tr class="memdesc:a0d3e1525d91adbbdcd5ac27793817112 inherit pub_methods_classGCMCommon"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroys this cipher object after clearing sensitive information. <br /></td></tr>
<tr class="separator:a0d3e1525d91adbbdcd5ac27793817112 inherit pub_methods_classGCMCommon"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a147fe5e5aabdb4ae01863fd89a4df739 inherit pub_methods_classGCMCommon"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGCMCommon.html#a147fe5e5aabdb4ae01863fd89a4df739">keySize</a> () const</td></tr>
<tr class="memdesc:a147fe5e5aabdb4ae01863fd89a4df739 inherit pub_methods_classGCMCommon"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default size of the key for this cipher, in bytes.  <a href="classGCMCommon.html#a147fe5e5aabdb4ae01863fd89a4df739">More...</a><br /></td></tr>
<tr class="separator:a147fe5e5aabdb4ae01863fd89a4df739 inherit pub_methods_classGCMCommon"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a318b3f4b39d8ccbf1a05c818dd8eab08 inherit pub_methods_classGCMCommon"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGCMCommon.html#a318b3f4b39d8ccbf1a05c818dd8eab08">ivSize</a> () const</td></tr>
<tr class="memdesc:a318b3f4b39d8ccbf1a05c818dd8eab08 inherit pub_methods_classGCMCommon"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of the initialization vector for this cipher, in bytes.  <a href="classGCMCommon.html#a318b3f4b39d8ccbf1a05c818dd8eab08">More...</a><br /></td></tr>
<tr class="separator:a318b3f4b39d8ccbf1a05c818dd8eab08 inherit pub_methods_classGCMCommon"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37d4497f58b0455fb44b41db6600521f inherit pub_methods_classGCMCommon"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGCMCommon.html#a37d4497f58b0455fb44b41db6600521f">tagSize</a> () const</td></tr>
<tr class="memdesc:a37d4497f58b0455fb44b41db6600521f inherit pub_methods_classGCMCommon"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the size of the authentication tag.  <a href="classGCMCommon.html#a37d4497f58b0455fb44b41db6600521f">More...</a><br /></td></tr>
<tr class="separator:a37d4497f58b0455fb44b41db6600521f inherit pub_methods_classGCMCommon"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a397c5dddde828c59eb63367385aec562 inherit pub_methods_classGCMCommon"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGCMCommon.html#a397c5dddde828c59eb63367385aec562">setKey</a> (const uint8_t *key, size_t len)</td></tr>
<tr class="memdesc:a397c5dddde828c59eb63367385aec562 inherit pub_methods_classGCMCommon"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the key to use for future encryption and decryption operations.  <a href="classGCMCommon.html#a397c5dddde828c59eb63367385aec562">More...</a><br /></td></tr>
<tr class="separator:a397c5dddde828c59eb63367385aec562 inherit pub_methods_classGCMCommon"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2545135fe42c832e40e057b603824524 inherit pub_methods_classGCMCommon"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGCMCommon.html#a2545135fe42c832e40e057b603824524">setIV</a> (const uint8_t *iv, size_t len)</td></tr>
<tr class="memdesc:a2545135fe42c832e40e057b603824524 inherit pub_methods_classGCMCommon"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the initialization vector to use for future encryption and decryption operations.  <a href="classGCMCommon.html#a2545135fe42c832e40e057b603824524">More...</a><br /></td></tr>
<tr class="separator:a2545135fe42c832e40e057b603824524 inherit pub_methods_classGCMCommon"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01ac69afe3d9fc4d72b2ea5dc242e55c inherit pub_methods_classGCMCommon"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGCMCommon.html#a01ac69afe3d9fc4d72b2ea5dc242e55c">encrypt</a> (uint8_t *output, const uint8_t *input, size_t len)</td></tr>
<tr class="memdesc:a01ac69afe3d9fc4d72b2ea5dc242e55c inherit pub_methods_classGCMCommon"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypts an input buffer and writes the ciphertext to an output buffer.  <a href="classGCMCommon.html#a01ac69afe3d9fc4d72b2ea5dc242e55c">More...</a><br /></td></tr>
<tr class="separator:a01ac69afe3d9fc4d72b2ea5dc242e55c inherit pub_methods_classGCMCommon"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60912d3ab5766aa68dc9b3111ac2c0d7 inherit pub_methods_classGCMCommon"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGCMCommon.html#a60912d3ab5766aa68dc9b3111ac2c0d7">decrypt</a> (uint8_t *output, const uint8_t *input, size_t len)</td></tr>
<tr class="memdesc:a60912d3ab5766aa68dc9b3111ac2c0d7 inherit pub_methods_classGCMCommon"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypts an input buffer and writes the plaintext to an output buffer.  <a href="classGCMCommon.html#a60912d3ab5766aa68dc9b3111ac2c0d7">More...</a><br /></td></tr>
<tr class="separator:a60912d3ab5766aa68dc9b3111ac2c0d7 inherit pub_methods_classGCMCommon"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad926e980ae2d61c10c9bf82813154a25 inherit pub_methods_classGCMCommon"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGCMCommon.html#ad926e980ae2d61c10c9bf82813154a25">addAuthData</a> (const void *data, size_t len)</td></tr>
<tr class="memdesc:ad926e980ae2d61c10c9bf82813154a25 inherit pub_methods_classGCMCommon"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds extra data that will be authenticated but not encrypted.  <a href="classGCMCommon.html#ad926e980ae2d61c10c9bf82813154a25">More...</a><br /></td></tr>
<tr class="separator:ad926e980ae2d61c10c9bf82813154a25 inherit pub_methods_classGCMCommon"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a444634bd4469bb5d404ac882d1d8fdf4 inherit pub_methods_classGCMCommon"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGCMCommon.html#a444634bd4469bb5d404ac882d1d8fdf4">computeTag</a> (void *tag, size_t len)</td></tr>
<tr class="memdesc:a444634bd4469bb5d404ac882d1d8fdf4 inherit pub_methods_classGCMCommon"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finalizes the encryption process and computes the authentication tag.  <a href="classGCMCommon.html#a444634bd4469bb5d404ac882d1d8fdf4">More...</a><br /></td></tr>
<tr class="separator:a444634bd4469bb5d404ac882d1d8fdf4 inherit pub_methods_classGCMCommon"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70229be2fe2274c4109fe7511481075a inherit pub_methods_classGCMCommon"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGCMCommon.html#a70229be2fe2274c4109fe7511481075a">checkTag</a> (const void *tag, size_t len)</td></tr>
<tr class="memdesc:a70229be2fe2274c4109fe7511481075a inherit pub_methods_classGCMCommon"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finalizes the decryption process and checks the authentication tag.  <a href="classGCMCommon.html#a70229be2fe2274c4109fe7511481075a">More...</a><br /></td></tr>
<tr class="separator:a70229be2fe2274c4109fe7511481075a inherit pub_methods_classGCMCommon"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06868ebd67a571aa68d88d5d072cece9 inherit pub_methods_classGCMCommon"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGCMCommon.html#a06868ebd67a571aa68d88d5d072cece9">clear</a> ()</td></tr>
<tr class="memdesc:a06868ebd67a571aa68d88d5d072cece9 inherit pub_methods_classGCMCommon"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clears all security-sensitive state from this cipher.  <a href="classGCMCommon.html#a06868ebd67a571aa68d88d5d072cece9">More...</a><br /></td></tr>
<tr class="separator:a06868ebd67a571aa68d88d5d072cece9 inherit pub_methods_classGCMCommon"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classAuthenticatedCipher"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classAuthenticatedCipher')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classAuthenticatedCipher.html">AuthenticatedCipher</a></td></tr>
<tr class="memitem:a0b1c0210ecb9d374d09b5b62a5140ba2 inherit pub_methods_classAuthenticatedCipher"><td class="memItemLeft" align="right" valign="top"><a id="a0b1c0210ecb9d374d09b5b62a5140ba2"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAuthenticatedCipher.html#a0b1c0210ecb9d374d09b5b62a5140ba2">AuthenticatedCipher</a> ()</td></tr>
<tr class="memdesc:a0b1c0210ecb9d374d09b5b62a5140ba2 inherit pub_methods_classAuthenticatedCipher"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a new authenticated cipher. <br /></td></tr>
<tr class="separator:a0b1c0210ecb9d374d09b5b62a5140ba2 inherit pub_methods_classAuthenticatedCipher"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae52a07be5b7265ea5898529ec21a79e4 inherit pub_methods_classAuthenticatedCipher"><td class="memItemLeft" align="right" valign="top"><a id="ae52a07be5b7265ea5898529ec21a79e4"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAuthenticatedCipher.html#ae52a07be5b7265ea5898529ec21a79e4">~AuthenticatedCipher</a> ()</td></tr>
<tr class="memdesc:ae52a07be5b7265ea5898529ec21a79e4 inherit pub_methods_classAuthenticatedCipher"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroys this authenticated cipher. <br /></td></tr>
<tr class="separator:ae52a07be5b7265ea5898529ec21a79e4 inherit pub_methods_classAuthenticatedCipher"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classCipher"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classCipher')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classCipher.html">Cipher</a></td></tr>
<tr class="memitem:a6a61077eca3ccd5900f92ceac58fb09c inherit pub_methods_classCipher"><td class="memItemLeft" align="right" valign="top"><a id="a6a61077eca3ccd5900f92ceac58fb09c"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCipher.html#a6a61077eca3ccd5900f92ceac58fb09c">Cipher</a> ()</td></tr>
<tr class="memdesc:a6a61077eca3ccd5900f92ceac58fb09c inherit pub_methods_classCipher"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a new cipher object. <br /></td></tr>
<tr class="separator:a6a61077eca3ccd5900f92ceac58fb09c inherit pub_methods_classCipher"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84bdea765f7e35aa5b5950dd2853a383 inherit pub_methods_classCipher"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCipher.html#a84bdea765f7e35aa5b5950dd2853a383">~Cipher</a> ()</td></tr>
<tr class="memdesc:a84bdea765f7e35aa5b5950dd2853a383 inherit pub_methods_classCipher"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroys this cipher object.  <a href="classCipher.html#a84bdea765f7e35aa5b5950dd2853a383">More...</a><br /></td></tr>
<tr class="separator:a84bdea765f7e35aa5b5950dd2853a383 inherit pub_methods_classCipher"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_classGCMCommon"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classGCMCommon')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classGCMCommon.html">GCMCommon</a></td></tr>
<tr class="memitem:a1b05ff393e8c20db30cb991e875aab19 inherit pro_methods_classGCMCommon"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGCMCommon.html#a1b05ff393e8c20db30cb991e875aab19">GCMCommon</a> ()</td></tr>
<tr class="memdesc:a1b05ff393e8c20db30cb991e875aab19 inherit pro_methods_classGCMCommon"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a new cipher in <a class="el" href="classGCM.html" title="Implementation of the Galois Counter Mode (GCM).">GCM</a> mode.  <a href="classGCMCommon.html#a1b05ff393e8c20db30cb991e875aab19">More...</a><br /></td></tr>
<tr class="separator:a1b05ff393e8c20db30cb991e875aab19 inherit pro_methods_classGCMCommon"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7abd3044862f8634f3b176aafa779ba2 inherit pro_methods_classGCMCommon"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGCMCommon.html#a7abd3044862f8634f3b176aafa779ba2">setBlockCipher</a> (<a class="el" href="classBlockCipher.html">BlockCipher</a> *cipher)</td></tr>
<tr class="memdesc:a7abd3044862f8634f3b176aafa779ba2 inherit pro_methods_classGCMCommon"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the block cipher to use for this <a class="el" href="classGCM.html" title="Implementation of the Galois Counter Mode (GCM).">GCM</a> object.  <a href="classGCMCommon.html#a7abd3044862f8634f3b176aafa779ba2">More...</a><br /></td></tr>
<tr class="separator:a7abd3044862f8634f3b176aafa779ba2 inherit pro_methods_classGCMCommon"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename T&gt;<br />
class GCM&lt; T &gt;</h3>

<p>Implementation of the Galois Counter Mode (<a class="el" href="classGCM.html" title="Implementation of the Galois Counter Mode (GCM).">GCM</a>). </p>
<p><a class="el" href="classGCM.html" title="Implementation of the Galois Counter Mode (GCM).">GCM</a> mode converts a block cipher into an authenticated cipher that uses the block cipher T to encrypt and <a class="el" href="classGHASH.html" title="Implementation of the GHASH message authenticator.">GHASH</a> to authenticate.</p>
<p>The size of the key is determined by the underlying block cipher T. The IV is recommended to be 96 bits (12 bytes) in length, but other lengths are supported as well. The default <a class="el" href="classGCMCommon.html#a37d4497f58b0455fb44b41db6600521f" title="Returns the size of the authentication tag.">tagSize()</a> is 128 bits (16 bytes) but the <a class="el" href="classGCM.html" title="Implementation of the Galois Counter Mode (GCM).">GCM</a> specification does allow other tag sizes: 32, 64, 96, 104, 112, 120, or 128 bits (4, 8, 12, 13, 14, 15, or 16 bytes).</p>
<p>The template parameter T must be a concrete subclass of <a class="el" href="classBlockCipher.html" title="Abstract base class for block ciphers.">BlockCipher</a> indicating the specific block cipher to use. The block cipher must have a block size of 128 bits. For example, the following creates a <a class="el" href="classGCM.html" title="Implementation of the Galois Counter Mode (GCM).">GCM</a> object using <a class="el" href="classAES256.html" title="AES block cipher with 256-bit keys.">AES256</a> as the underlying cipher and then uses it to encrypt and authenticate a <code>plaintext</code> block:</p>
<div class="fragment"><div class="line"><a class="code" href="classGCM.html">GCM&lt;AES256&gt;</a> gcm;</div>
<div class="line">gcm.<a class="code" href="classGCMCommon.html#a397c5dddde828c59eb63367385aec562">setKey</a>(key, <span class="keyword">sizeof</span>(key));</div>
<div class="line">gcm.<a class="code" href="classGCMCommon.html#a2545135fe42c832e40e057b603824524">setIV</a>(iv, <span class="keyword">sizeof</span>(iv));</div>
<div class="line">gcm.<a class="code" href="classGCMCommon.html#ad926e980ae2d61c10c9bf82813154a25">addAuthData</a>(adata, <span class="keyword">sizeof</span>(adata));</div>
<div class="line">gcm.<a class="code" href="classGCMCommon.html#a01ac69afe3d9fc4d72b2ea5dc242e55c">encrypt</a>(ciphertext, plaintext, <span class="keyword">sizeof</span>(plaintext));</div>
<div class="line">gcm.<a class="code" href="classGCMCommon.html#a444634bd4469bb5d404ac882d1d8fdf4">computeTag</a>(tag, <span class="keyword">sizeof</span>(tag));</div>
<div class="ttc" id="aclassGCMCommon_html_a01ac69afe3d9fc4d72b2ea5dc242e55c"><div class="ttname"><a href="classGCMCommon.html#a01ac69afe3d9fc4d72b2ea5dc242e55c">GCMCommon::encrypt</a></div><div class="ttdeci">void encrypt(uint8_t *output, const uint8_t *input, size_t len)</div><div class="ttdoc">Encrypts an input buffer and writes the ciphertext to an output buffer.</div><div class="ttdef"><b>Definition:</b> <a href="GCM_8cpp_source.html#l00142">GCM.cpp:142</a></div></div>
<div class="ttc" id="aclassGCMCommon_html_a2545135fe42c832e40e057b603824524"><div class="ttname"><a href="classGCMCommon.html#a2545135fe42c832e40e057b603824524">GCMCommon::setIV</a></div><div class="ttdeci">bool setIV(const uint8_t *iv, size_t len)</div><div class="ttdoc">Sets the initialization vector to use for future encryption and decryption operations.</div><div class="ttdef"><b>Definition:</b> <a href="GCM_8cpp_source.html#l00083">GCM.cpp:83</a></div></div>
<div class="ttc" id="aclassGCMCommon_html_a397c5dddde828c59eb63367385aec562"><div class="ttname"><a href="classGCMCommon.html#a397c5dddde828c59eb63367385aec562">GCMCommon::setKey</a></div><div class="ttdeci">bool setKey(const uint8_t *key, size_t len)</div><div class="ttdoc">Sets the key to use for future encryption and decryption operations.</div><div class="ttdef"><b>Definition:</b> <a href="GCM_8cpp_source.html#l00077">GCM.cpp:77</a></div></div>
<div class="ttc" id="aclassGCMCommon_html_a444634bd4469bb5d404ac882d1d8fdf4"><div class="ttname"><a href="classGCMCommon.html#a444634bd4469bb5d404ac882d1d8fdf4">GCMCommon::computeTag</a></div><div class="ttdeci">void computeTag(void *tag, size_t len)</div><div class="ttdoc">Finalizes the encryption process and computes the authentication tag.</div><div class="ttdef"><b>Definition:</b> <a href="GCM_8cpp_source.html#l00222">GCM.cpp:222</a></div></div>
<div class="ttc" id="aclassGCMCommon_html_ad926e980ae2d61c10c9bf82813154a25"><div class="ttname"><a href="classGCMCommon.html#ad926e980ae2d61c10c9bf82813154a25">GCMCommon::addAuthData</a></div><div class="ttdeci">void addAuthData(const void *data, size_t len)</div><div class="ttdoc">Adds extra data that will be authenticated but not encrypted.</div><div class="ttdef"><b>Definition:</b> <a href="GCM_8cpp_source.html#l00214">GCM.cpp:214</a></div></div>
<div class="ttc" id="aclassGCM_html"><div class="ttname"><a href="classGCM.html">GCM</a></div><div class="ttdoc">Implementation of the Galois Counter Mode (GCM).</div><div class="ttdef"><b>Definition:</b> <a href="GCM_8h_source.html#l00071">GCM.h:72</a></div></div>
</div><!-- fragment --><p>The decryption process is almost identical to convert a <code>ciphertext</code> and <em>tag</em> back into plaintext and then check the tag:</p>
<div class="fragment"><div class="line"><a class="code" href="classGCM.html">GCM&lt;AES256&gt;</a> gcm;</div>
<div class="line">gcm.<a class="code" href="classGCMCommon.html#a397c5dddde828c59eb63367385aec562">setKey</a>(key, <span class="keyword">sizeof</span>(key));</div>
<div class="line">gcm.<a class="code" href="classGCMCommon.html#a2545135fe42c832e40e057b603824524">setIV</a>(iv, <span class="keyword">sizeof</span>(iv));</div>
<div class="line">gcm.<a class="code" href="classGCMCommon.html#ad926e980ae2d61c10c9bf82813154a25">addAuthData</a>(adata, <span class="keyword">sizeof</span>(adata));</div>
<div class="line">gcm.<a class="code" href="classGCMCommon.html#a60912d3ab5766aa68dc9b3111ac2c0d7">decrypt</a>(plaintext, ciphertext, <span class="keyword">sizeof</span>(ciphertext));</div>
<div class="line"><span class="keywordflow">if</span> (!gcm.<a class="code" href="classGCMCommon.html#a70229be2fe2274c4109fe7511481075a">checkTag</a>(tag, <span class="keyword">sizeof</span>(tag))) {</div>
<div class="line">    <span class="comment">// The data was invalid - do not use it.</span></div>
<div class="line">    ...</div>
<div class="line">}</div>
<div class="ttc" id="aclassGCMCommon_html_a60912d3ab5766aa68dc9b3111ac2c0d7"><div class="ttname"><a href="classGCMCommon.html#a60912d3ab5766aa68dc9b3111ac2c0d7">GCMCommon::decrypt</a></div><div class="ttdeci">void decrypt(uint8_t *output, const uint8_t *input, size_t len)</div><div class="ttdoc">Decrypts an input buffer and writes the plaintext to an output buffer.</div><div class="ttdef"><b>Definition:</b> <a href="GCM_8cpp_source.html#l00179">GCM.cpp:179</a></div></div>
<div class="ttc" id="aclassGCMCommon_html_a70229be2fe2274c4109fe7511481075a"><div class="ttname"><a href="classGCMCommon.html#a70229be2fe2274c4109fe7511481075a">GCMCommon::checkTag</a></div><div class="ttdeci">bool checkTag(const void *tag, size_t len)</div><div class="ttdoc">Finalizes the decryption process and checks the authentication tag.</div><div class="ttdef"><b>Definition:</b> <a href="GCM_8cpp_source.html#l00242">GCM.cpp:242</a></div></div>
</div><!-- fragment --><p>The <a class="el" href="classGCM.html" title="Implementation of the Galois Counter Mode (GCM).">GCM</a> class can also be used to implement GMAC message authentication by omitting the plaintext:</p>
<div class="fragment"><div class="line"><a class="code" href="classGCM.html">GCM&lt;AES256&gt;</a> gcm;</div>
<div class="line">gcm.<a class="code" href="classGCMCommon.html#a397c5dddde828c59eb63367385aec562">setKey</a>(key, <span class="keyword">sizeof</span>(key));</div>
<div class="line">gcm.<a class="code" href="classGCMCommon.html#a2545135fe42c832e40e057b603824524">setIV</a>(iv, <span class="keyword">sizeof</span>(iv));</div>
<div class="line">gcm.<a class="code" href="classGCMCommon.html#ad926e980ae2d61c10c9bf82813154a25">addAuthData</a>(adata1, <span class="keyword">sizeof</span>(adata1));</div>
<div class="line">gcm.<a class="code" href="classGCMCommon.html#ad926e980ae2d61c10c9bf82813154a25">addAuthData</a>(adata2, <span class="keyword">sizeof</span>(adata1));</div>
<div class="line">...</div>
<div class="line">gcm.addAuthData(adataN, <span class="keyword">sizeof</span>(adataN));</div>
<div class="line">gcm.<a class="code" href="classGCMCommon.html#a444634bd4469bb5d404ac882d1d8fdf4">computeTag</a>(tag, <span class="keyword">sizeof</span>(tag));</div>
</div><!-- fragment --><p>References: <a href="http://csrc.nist.gov/publications/nistpubs/800-38D/SP-800-38D.pdf">NIST SP 800-38D</a>, <a href="http://en.wikipedia.org/wiki/Galois/Counter_Mode">http://en.wikipedia.org/wiki/Galois/Counter_Mode</a></p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classGCMCommon.html" title="Concrete base class to assist with implementing GCM for 128-bit block ciphers.">GCMCommon</a>, <a class="el" href="classGHASH.html" title="Implementation of the GHASH message authenticator.">GHASH</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="GCM_8h_source.html#l00071">71</a> of file <a class="el" href="GCM_8h_source.html">GCM.h</a>.</p>
</div><hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="GCM_8h_source.html">GCM.h</a></li>
<li><a class="el" href="GCM_8cpp_source.html">GCM.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Apr 1 2023 09:42:59 for Arduino Cryptography Library by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
