<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Arduino Cryptography Library: Ed25519 Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Arduino Cryptography Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classEd25519-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Ed25519 Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Digital signatures based on the elliptic curve modulo 2^255 - 19.  
 <a href="classEd25519.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="Ed25519_8h_source.html">Ed25519.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a36ecf67b4c5d2d39a31888f56af1f8a5"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEd25519.html#a36ecf67b4c5d2d39a31888f56af1f8a5">sign</a> (uint8_t signature[64], const uint8_t privateKey[32], const uint8_t publicKey[32], const void *message, size_t len)</td></tr>
<tr class="memdesc:a36ecf67b4c5d2d39a31888f56af1f8a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Signs a message using a specific <a class="el" href="classEd25519.html" title="Digital signatures based on the elliptic curve modulo 2^255 - 19.">Ed25519</a> private key.  <a href="classEd25519.html#a36ecf67b4c5d2d39a31888f56af1f8a5">More...</a><br /></td></tr>
<tr class="separator:a36ecf67b4c5d2d39a31888f56af1f8a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3e2fc405c9cd8cb1d3ab9b8b452d3e4"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEd25519.html#ae3e2fc405c9cd8cb1d3ab9b8b452d3e4">verify</a> (const uint8_t signature[64], const uint8_t publicKey[32], const void *message, size_t len)</td></tr>
<tr class="memdesc:ae3e2fc405c9cd8cb1d3ab9b8b452d3e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies a signature using a specific <a class="el" href="classEd25519.html" title="Digital signatures based on the elliptic curve modulo 2^255 - 19.">Ed25519</a> public key.  <a href="classEd25519.html#ae3e2fc405c9cd8cb1d3ab9b8b452d3e4">More...</a><br /></td></tr>
<tr class="separator:ae3e2fc405c9cd8cb1d3ab9b8b452d3e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8be5115ac5adc8a556dbac7d7e90d2e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEd25519.html#ab8be5115ac5adc8a556dbac7d7e90d2e">generatePrivateKey</a> (uint8_t privateKey[32])</td></tr>
<tr class="memdesc:ab8be5115ac5adc8a556dbac7d7e90d2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a private key for <a class="el" href="classEd25519.html" title="Digital signatures based on the elliptic curve modulo 2^255 - 19.">Ed25519</a> signing operations.  <a href="classEd25519.html#ab8be5115ac5adc8a556dbac7d7e90d2e">More...</a><br /></td></tr>
<tr class="separator:ab8be5115ac5adc8a556dbac7d7e90d2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab62bac52ed07f77f76f3ff0fccd71cb2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEd25519.html#ab62bac52ed07f77f76f3ff0fccd71cb2">derivePublicKey</a> (uint8_t publicKey[32], const uint8_t privateKey[32])</td></tr>
<tr class="memdesc:ab62bac52ed07f77f76f3ff0fccd71cb2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derives the public key from a private key.  <a href="classEd25519.html#ab62bac52ed07f77f76f3ff0fccd71cb2">More...</a><br /></td></tr>
<tr class="separator:ab62bac52ed07f77f76f3ff0fccd71cb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Digital signatures based on the elliptic curve modulo 2^255 - 19. </p>
<p>The first step in creating a digital signature with <a class="el" href="classEd25519.html" title="Digital signatures based on the elliptic curve modulo 2^255 - 19.">Ed25519</a> is to generate a key pair:</p>
<div class="fragment"><div class="line">uint8_t privateKey[32];</div>
<div class="line">uint8_t publicKey[32];</div>
<div class="line"> </div>
<div class="line"><a class="code" href="classEd25519.html#ab8be5115ac5adc8a556dbac7d7e90d2e">Ed25519::generatePrivateKey</a>(privateKey);</div>
<div class="line"><a class="code" href="classEd25519.html#ab62bac52ed07f77f76f3ff0fccd71cb2">Ed25519::derivePublicKey</a>(publicKey, privateKey);</div>
<div class="ttc" id="aclassEd25519_html_ab62bac52ed07f77f76f3ff0fccd71cb2"><div class="ttname"><a href="classEd25519.html#ab62bac52ed07f77f76f3ff0fccd71cb2">Ed25519::derivePublicKey</a></div><div class="ttdeci">static void derivePublicKey(uint8_t publicKey[32], const uint8_t privateKey[32])</div><div class="ttdoc">Derives the public key from a private key.</div><div class="ttdef"><b>Definition:</b> <a href="Ed25519_8cpp_source.html#l00256">Ed25519.cpp:256</a></div></div>
<div class="ttc" id="aclassEd25519_html_ab8be5115ac5adc8a556dbac7d7e90d2e"><div class="ttname"><a href="classEd25519.html#ab8be5115ac5adc8a556dbac7d7e90d2e">Ed25519::generatePrivateKey</a></div><div class="ttdeci">static void generatePrivateKey(uint8_t privateKey[32])</div><div class="ttdoc">Generates a private key for Ed25519 signing operations.</div><div class="ttdef"><b>Definition:</b> <a href="Ed25519_8cpp_source.html#l00243">Ed25519.cpp:243</a></div></div>
</div><!-- fragment --><p>The application can store both the private and public key for later signing operations. Or it can store just the private key and then derive the public key at the point where signing is to occur.</p>
<p>Message signing produces a 64-byte signature as follows:</p>
<div class="fragment"><div class="line">uint8_t message[N];</div>
<div class="line">uint8_t signature[64];</div>
<div class="line"> </div>
<div class="line"><a class="code" href="classEd25519.html#a36ecf67b4c5d2d39a31888f56af1f8a5">Ed25519::sign</a>(signature, privateKey, publicKey, message, N);</div>
<div class="ttc" id="aclassEd25519_html_a36ecf67b4c5d2d39a31888f56af1f8a5"><div class="ttname"><a href="classEd25519.html#a36ecf67b4c5d2d39a31888f56af1f8a5">Ed25519::sign</a></div><div class="ttdeci">static void sign(uint8_t signature[64], const uint8_t privateKey[32], const uint8_t publicKey[32], const void *message, size_t len)</div><div class="ttdoc">Signs a message using a specific Ed25519 private key.</div><div class="ttdef"><b>Definition:</b> <a href="Ed25519_8cpp_source.html#l00127">Ed25519.cpp:127</a></div></div>
</div><!-- fragment --><p>And then to verify the signature:</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (!<a class="code" href="classEd25519.html#ae3e2fc405c9cd8cb1d3ab9b8b452d3e4">Ed25519::verify</a>(signature, publicKey, message, N)) {</div>
<div class="line">    <span class="comment">// The signature is invalid.</span></div>
<div class="line">    ...</div>
<div class="line">}</div>
<div class="ttc" id="aclassEd25519_html_ae3e2fc405c9cd8cb1d3ab9b8b452d3e4"><div class="ttname"><a href="classEd25519.html#ae3e2fc405c9cd8cb1d3ab9b8b452d3e4">Ed25519::verify</a></div><div class="ttdeci">static bool verify(const uint8_t signature[64], const uint8_t publicKey[32], const void *message, size_t len)</div><div class="ttdoc">Verifies a signature using a specific Ed25519 public key.</div><div class="ttdef"><b>Definition:</b> <a href="Ed25519_8cpp_source.html#l00189">Ed25519.cpp:189</a></div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>The public functions in this class need a substantial amount of stack space to store intermediate results while the curve function is being evaluated. About 1.5k of free stack space is recommended for safety.</dd></dl>
<p>References: <a href="https://tools.ietf.org/html/draft-irtf-cfrg-eddsa-05">https://tools.ietf.org/html/draft-irtf-cfrg-eddsa-05</a></p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classCurve25519.html" title="Diffie-Hellman key agreement based on the elliptic curve modulo 2^255 - 19.">Curve25519</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="Ed25519_8h_source.html#l00029">29</a> of file <a class="el" href="Ed25519_8h_source.html">Ed25519.h</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="ab62bac52ed07f77f76f3ff0fccd71cb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab62bac52ed07f77f76f3ff0fccd71cb2">&#9670;&nbsp;</a></span>derivePublicKey()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Ed25519::derivePublicKey </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>publicKey</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>privateKey</em>[32]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Derives the public key from a private key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">publicKey</td><td>The public key. </td></tr>
    <tr><td class="paramname">privateKey</td><td>The private key.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classEd25519.html#ab8be5115ac5adc8a556dbac7d7e90d2e" title="Generates a private key for Ed25519 signing operations.">generatePrivateKey()</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="Ed25519_8cpp_source.html#l00256">256</a> of file <a class="el" href="Ed25519_8cpp_source.html">Ed25519.cpp</a>.</p>

</div>
</div>
<a id="ab8be5115ac5adc8a556dbac7d7e90d2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8be5115ac5adc8a556dbac7d7e90d2e">&#9670;&nbsp;</a></span>generatePrivateKey()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Ed25519::generatePrivateKey </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>privateKey</em>[32]</td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generates a private key for <a class="el" href="classEd25519.html" title="Digital signatures based on the elliptic curve modulo 2^255 - 19.">Ed25519</a> signing operations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">privateKey</td><td>The resulting private key.</td></tr>
  </table>
  </dd>
</dl>
<p>The private key is generated with <a class="el" href="classRNGClass.html#a418a833cf18198fd7e5d6dbd78c99c29">RNG.rand()</a>. It is the caller's responsibility to ensure that the global random number pool has sufficient entropy to generate the 32 bytes of the key safely before calling this function.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classEd25519.html#ab62bac52ed07f77f76f3ff0fccd71cb2" title="Derives the public key from a private key.">derivePublicKey()</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="Ed25519_8cpp_source.html#l00243">243</a> of file <a class="el" href="Ed25519_8cpp_source.html">Ed25519.cpp</a>.</p>

</div>
</div>
<a id="a36ecf67b4c5d2d39a31888f56af1f8a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36ecf67b4c5d2d39a31888f56af1f8a5">&#9670;&nbsp;</a></span>sign()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Ed25519::sign </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>signature</em>[64], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>privateKey</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>publicKey</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Signs a message using a specific <a class="el" href="classEd25519.html" title="Digital signatures based on the elliptic curve modulo 2^255 - 19.">Ed25519</a> private key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">signature</td><td>The signature value. </td></tr>
    <tr><td class="paramname">privateKey</td><td>The private key to use to sign the message. </td></tr>
    <tr><td class="paramname">publicKey</td><td>The public key corresponding to <em>privateKey</em>. </td></tr>
    <tr><td class="paramname">message</td><td>Points to the message to be signed. </td></tr>
    <tr><td class="paramname">len</td><td>The length of the <em>message</em> to be signed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classEd25519.html#ae3e2fc405c9cd8cb1d3ab9b8b452d3e4" title="Verifies a signature using a specific Ed25519 public key.">verify()</a>, <a class="el" href="classEd25519.html#ab62bac52ed07f77f76f3ff0fccd71cb2" title="Derives the public key from a private key.">derivePublicKey()</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="Ed25519_8cpp_source.html#l00127">127</a> of file <a class="el" href="Ed25519_8cpp_source.html">Ed25519.cpp</a>.</p>

</div>
</div>
<a id="ae3e2fc405c9cd8cb1d3ab9b8b452d3e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3e2fc405c9cd8cb1d3ab9b8b452d3e4">&#9670;&nbsp;</a></span>verify()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Ed25519::verify </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>signature</em>[64], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>publicKey</em>[32], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Verifies a signature using a specific <a class="el" href="classEd25519.html" title="Digital signatures based on the elliptic curve modulo 2^255 - 19.">Ed25519</a> public key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">signature</td><td>The signature value to be verified. </td></tr>
    <tr><td class="paramname">publicKey</td><td>The public key to use to verify the signature. </td></tr>
    <tr><td class="paramname">message</td><td>The message whose signature is to be verified. </td></tr>
    <tr><td class="paramname">len</td><td>The length of the <em>message</em> to be verified.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true if the <em>signature</em> is valid for <em>message</em>; or false if the <em>signature</em> is not valid.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classEd25519.html#a36ecf67b4c5d2d39a31888f56af1f8a5" title="Signs a message using a specific Ed25519 private key.">sign()</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="Ed25519_8cpp_source.html#l00189">189</a> of file <a class="el" href="Ed25519_8cpp_source.html">Ed25519.cpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="Ed25519_8h_source.html">Ed25519.h</a></li>
<li><a class="el" href="Ed25519_8cpp_source.html">Ed25519.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Apr 1 2023 09:42:59 for Arduino Cryptography Library by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
